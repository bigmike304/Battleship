<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Battleship</title>
    <!-- Google Fonts: Fraktur for title, Futura-like for UI -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=UnifrakturMaguntia&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/css/theme.css" />
    <link rel="stylesheet" href="/src/styles.css" />
  </head>
  <body>
    <div id="app">
      <h1>Battleship</h1>
      
      <!-- Phase Indicator -->
      <div id="phase-indicator" class="phase-indicator" role="status" aria-live="polite">
        <span class="phase-label">Phase:</span>
        <span id="phase-text" class="phase-text">Setup</span>
      </div>

      <!-- How to Play Panel (Collapsible) -->
      <details id="how-to-play" class="how-to-play">
        <summary>How to Play</summary>
        <div class="how-to-play-content">
          <ol>
            <li><strong>Setup Phase:</strong> Choose manual or random ship placement. Place all 5 ships on your board.</li>
            <li><strong>Start Game:</strong> Click "Start Game" when your fleet is ready.</li>
            <li><strong>Your Turn:</strong> Click on the enemy grid to fire. Hits are marked with an explosion, misses with a splash.</li>
            <li><strong>AI Turn:</strong> The AI will fire back. Watch your fleet!</li>
            <li><strong>Win:</strong> Sink all 5 enemy ships before they sink yours.</li>
          </ol>
          <p><strong>Ships:</strong> Carrier (5), Battleship (4), Cruiser (3), Submarine (3), Destroyer (2)</p>
          <h4>Difficulty Levels</h4>
          <ul class="difficulty-descriptions">
            <li><strong>Easy:</strong> AI fires randomly at any available cell.</li>
            <li><strong>Normal:</strong> AI uses Hunt/Target logic - after a hit, it targets adjacent cells to sink ships faster.</li>
            <li><strong>Hard:</strong> AI uses parity hunting (checkerboard pattern) plus Hunt/Target for maximum efficiency.</li>
          </ul>
        </div>
      </details>

      <!-- Setup Section - ALL setup controls grouped together at top -->
      <section id="setup-section" class="setup-section">
        <!-- Placement Mode Selection -->
        <div id="placement-mode-selection" class="placement-mode-selection">
          <h3>Choose Placement Mode</h3>
          <div class="mode-buttons">
            <button id="manual-mode-btn" class="icon-btn" aria-label="Manual ship placement">
              <img src="/assets/ui/manual.svg" alt="" aria-hidden="true" />
              <span>Manual Placement</span>
            </button>
            <button id="random-mode-btn" class="icon-btn" aria-label="Random ship placement">
              <img src="/assets/ui/random.svg" alt="" aria-hidden="true" />
              <span>Random Placement</span>
            </button>
          </div>
        </div>

        <!-- Setup Action Buttons (directly under placement mode) -->
        <div id="setup-controls" class="setup-controls">
          <button id="randomize-btn">Randomize My Ships</button>
          <button id="start-btn" disabled>Start Game</button>
        </div>

        <!-- AI Difficulty Selector -->
        <div id="difficulty-selector" class="difficulty-selector">
          <label for="difficulty-select">AI Difficulty:</label>
          <select id="difficulty-select" aria-label="Select AI difficulty level">
            <option value="easy">Easy - Random shots</option>
            <option value="normal" selected>Normal - Hunt/Target</option>
            <option value="hard">Hard - Parity + Hunt/Target</option>
          </select>
        </div>

        <!-- Sound Toggle -->
        <div id="sound-toggle-section" class="sound-toggle-section">
          <label for="sound-toggle">Sound:</label>
          <button id="sound-toggle" class="sound-toggle-btn" aria-label="Toggle sound effects">On</button>
        </div>

        <!-- Player Name Input with Save Button -->
        <div id="player-name-section" class="player-name-section">
          <label for="player-name-input">Player Name:</label>
          <input type="text" id="player-name-input" placeholder="Enter your name" maxlength="20" />
          <button id="save-name-btn" class="save-name-btn">Save Name</button>
          <span id="name-save-status" class="name-save-status"></span>
        </div>
      </section>

      <!-- Shot Counter (shown during gameplay) -->
      <div id="shot-counter" class="shot-counter" style="display: none;">
        <span class="shot-label">Shots:</span>
        <span id="shot-count" class="shot-count">0</span>
      </div>

      <!-- Ship Tray for Manual Placement -->
      <div id="ship-tray-container" class="ship-tray-container" style="display: none;">
        <h3>Place Your Ships</h3>
        <div id="ship-tray" class="ship-tray" role="listbox" aria-label="Available ships to place"></div>
        <div id="placement-controls">
          <button id="rotate-btn" class="icon-btn" aria-label="Rotate ship orientation">
            <img src="/assets/ui/rotate.svg" alt="" aria-hidden="true" />
            <span>Rotate (R)</span>
          </button>
          <button id="clear-placement-btn" aria-label="Clear all placed ships">Clear All</button>
          <button id="change-mode-btn" class="change-mode-btn" aria-label="Change placement mode">Change Mode</button>
        </div>
        <p id="placement-instructions">Click a ship to select, then click on the board to place. Right-click or press R to rotate.</p>
      </div>

      <!-- Game Boards -->
      <div id="game-container">
        <div id="player-section">
          <h2>Your Fleet</h2>
          <div class="board-wrapper">
            <div class="column-labels" aria-hidden="true">
              <span></span>
              <span>A</span><span>B</span><span>C</span><span>D</span><span>E</span>
              <span>F</span><span>G</span><span>H</span><span>I</span><span>J</span>
            </div>
            <div class="board-with-rows">
              <div class="row-labels" aria-hidden="true">
                <span>1</span><span>2</span><span>3</span><span>4</span><span>5</span>
                <span>6</span><span>7</span><span>8</span><span>9</span><span>10</span>
              </div>
              <div id="player-board" class="board" role="grid" aria-label="Your fleet board"></div>
            </div>
          </div>
        </div>
        <div id="enemy-section">
          <h2>Enemy Waters</h2>
          <div class="board-wrapper">
            <div class="column-labels" aria-hidden="true">
              <span></span>
              <span>A</span><span>B</span><span>C</span><span>D</span><span>E</span>
              <span>F</span><span>G</span><span>H</span><span>I</span><span>J</span>
            </div>
            <div class="board-with-rows">
              <div class="row-labels" aria-hidden="true">
                <span>1</span><span>2</span><span>3</span><span>4</span><span>5</span>
                <span>6</span><span>7</span><span>8</span><span>9</span><span>10</span>
              </div>
              <div id="enemy-board" class="board" role="grid" aria-label="Enemy waters - click to fire"></div>
            </div>
          </div>
        </div>
      </div>

      <!-- Game Controls (shown during gameplay) -->
      <div id="game-controls" style="display: none;">
        <button id="restart-btn">Restart Game</button>
      </div>

      <!-- Battle Log -->
      <div id="message-log">
        <h3>Battle Log</h3>
        <div id="messages" role="log" aria-live="polite" aria-label="Game events log"></div>
      </div>

      <!-- Leaderboard Panel -->
      <div id="leaderboard-panel" class="leaderboard-panel">
        <h3>Leaderboard</h3>
        <div id="leaderboard-list" class="leaderboard-list">
          <p class="leaderboard-empty">No scores yet. Win a game to get on the board!</p>
        </div>
        <button id="clear-leaderboard-btn" class="clear-leaderboard-btn">Clear Leaderboard</button>
      </div>

      <!-- Footer with Sound Toggle -->
      <footer class="app-footer">
        <div class="footer-content">
          <span class="footer-text">Battleship Game</span>
          <div class="footer-sound-toggle">
            <label for="footer-sound-toggle">Sound:</label>
            <button id="footer-sound-toggle" class="sound-toggle-btn" aria-label="Toggle sound effects">On</button>
          </div>
        </div>
      </footer>
    </div>
    <script type="module" src="/src/main.js"></script>
  </body>
</html>
